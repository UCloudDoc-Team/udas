# 2、保护对象

配置需要保护的数据库，支持十几种数据库类型审计，包括后关系型数据库cache，HBASE、MongoDB等大数据审计，达梦、人大金仓等国产数据库的审计。审计对数据库进行操作的行为，配置相应的策略将危险性行为特别标注出来，帮助用户快速发现危险操作行为，及时作出处理措施。

## 1）保护对象配置

点击界面“添加”按钮，弹出添加保护对象对话框

![](/images/operation/rule/bhdx1.png)

![](/images/operation/rule/bhdx2.png)

态：状态设置为OFF后，该保护对象流量将直接过滤，不会进行审计产生审计记录。
告警：告警状态设置为ON后，必须配置告警策略才能保存配置，当对该保护对象数据库进行操作的行为触发了审计策略中的规则，且触发的规则风险等级与告警策略配置的等级一致时，则会通过配置的告警策略发送告警。
版本号：部分数据库随着版本号的不同，审计出来的展示效果会有略微不同，会存在小细节的不完整，但不影响审计的正确性。建议为了查看最佳的审计效果，配置的数据库版本与实际一致。
IP地址：支持IPV4地址段的审计，比如172.23.1.23-172.23.1.29。IPV6不支持地址段的审计。
端口号：可输入多端口，用‘|’隔开,比如3300|3301|3306。
数据库字符集：根据自己数据库安装时的配置选择编码，编码选择错误可能会导致乱码问题。
HIS厂商：配合中间件middleware使用，对特定厂商进行审计，根据实际配置。
审计策略：按需配置。
告警策略：按需配置。

## 2）自动发现

如果用户存在较多资产都需要配置保护对象的时候，手动进行配置显然不是一个好方法，那么我们通过自动发现功能，实现资产的批量添加，从而提高操作效率。点击保护对象中的自动发现按钮，弹出配置界面。地址范围，任务执行时间和数据库类型可以根据实际情况进行填写，发现类型包括“全部”和“端口扫描”，填写完成后即可开始扫描。

![](/images/operation/rule/bhdx3.png)

扫描完成后可以点击完成资产的批量添加，或者点击实现单台添加；另外扫描的结果也是可以查询的，通过输入对应的地址，数据库类型，任务执行时间段还有处理状态来进行查询。

