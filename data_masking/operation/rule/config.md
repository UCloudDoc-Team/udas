# 5、脱敏配置管理

此模块提供的是脱敏规则、敏感类型、数据字典的配置管理。

## 5.1 脱敏规则

该功能可用于用户对敏感数据的脱敏方式自主选择，可对需要脱敏的数据区域进行覆盖、随机、替换、映射、加密的配置。灵活应用脱敏规则可以大大提高脱敏的效率。

### 5.1.1 添加规则

点击“添加”按钮填入信息即可完成对脱敏规则的添加。

![](/images/operation/rule/config/config_1.png)                               

在添加页面输入如下配置的信息点击“保存”即完成一个自定义规则的添加：

| 规则名称 | Test002（自定义）        |
| -------- | ------------------------ |
| 规则描述 | 添加脱敏规则（非必填）   |
| 规则类型 | 姓名（敏感类型名称）     |
| 脱敏方式 | 覆盖                     |
| 脱敏区域 | A区：*            B区：+ |

a. 规则名称：输入符合输入框校验的名称即可；

b. 规则描述：非必填项，根据实际需要选填；

c. 敏感类型：可选择系统敏感类型模块种所有的敏感类型的一种，根据实际需要进行选择；

d. 脱敏方式：目前系统支持覆盖、随机、替换、映射、SHA256算法、可逆、可逆还原七种脱敏算法

e. 脱敏区域：根据实际需要进行选择脱敏的区域

### 5.1.2 删除和修改

删除：规则删除可以进行批量操作和单一操作，点击规则左侧的复选框来完成规则的选择，然后点击删除按钮就可以删除选中的规则。

修改：修改规则点击右侧操作栏中的修改按钮即可进行除规则名称和敏感类型之外的修改。

**注：内置规则无法被删除和修改。**

### 5.1.3 其他操作

查看详情：点击脱敏规则右侧的  ，会展示脱敏规则的详细信息。

搜索：可以对规则名称、脱敏方式、敏感类型进行模糊搜索

系统会内置常用的脱敏规则，方便用户在未创建自定义脱敏规则的情况下直接使用进行数据的脱敏。

## 5.2 访问控制

该模块可对动态脱敏查询的操作进行增删改查，内置有15种规则。该模块所有的规则可在动态脱敏代理服务账号配置中的引用代理服务列表中的访问控制中引用。

### 5.2.1 添加规则

添加一个访问控制规则，点击按钮添加，再弹框内输入内容点击保存即可完成添加。

![](/images/operation/rule/config/config_2.png)                               

在配置页面种输入以下配置信息，点击“保存”即完成一个自定义访问控制规则的添加：

| 规则名称 | 查询所有（自定义）           |
| -------- | ---------------------------- |
| 规则内容 | select *（SQL语句）          |
| 描述     | 查询所有的访问控制（非必填） |

### 5.2.2 其他操作

删除：访问控制删除可以进行单一删除和多个删除，点击左侧的选择按钮来完成选择，然后点击删除按钮就可以删除选中的访问控制；

修改：修改访问控制点击右侧操作栏中的修改按钮即可进行所有项的修改。

注：内置规则可以被删除和修改

## 5.3 脱敏规则组

该功能对敏感信息进行脱敏处理的规则组管理，内置的规则组可以进行增删改查的操作。脱敏规则组是脱敏规则的集合，通过对规则进行整合，可以让脱敏对象批量应用规则，同时也方便用户对规则进行管理。

 ![](/images/operation/rule/config/config_3.png)

### 5.3.1添加规则组

点击添加按钮，在添加规则组弹窗中填入规则组名称，然后选先选择敏感类型，再根据敏感类型选择脱敏规则，脱敏规则选中后的符号为  ，想要删除规则点击规则组内容中规则右侧的“删除”字样即可。选择的会显示在规则组的详细信息中，点击保存即可添加成功。

![](/images/operation/rule/config/config_5.png) 

a. 脱敏规则配置：可选择系统种存在的所有敏感类型的一个脱敏规则添加到规则组内。

### 5.3.2 删除和修改

删除：规则组删除可以进行批量操作和单一操作，点击规则左侧的选择按钮或者选择全部来完成规则组的选择，然后点击删除按钮就可以删除选中的规则组。

修改：点击右侧操作栏中的修改按钮即可进行除规则组名称以外所有信息的修改。

### 5.3.5 其他操作

搜索：可以对规则组名称进行模糊搜索

查看详情：点击每一条规则组的详细信息中的查看全部即可查看到该规则组的所有敏感类型和敏感规则。

## 5.5 敏感类型

目前系统内置有20种敏感类型，包含常用的个人信息敏感类型，例如：姓名、手机号、身份证号、银行卡号、地址等，也包括一些金融行业的敏感类型。如果内置的敏感类型不满足需求，系统种还可以自定义对应的敏感类型，自定义敏感类型的匹配方式包含正则、数据字典、以及引用其他敏感类型等多种方式。

### 5.5.1 敏感类型添加

在敏感类型模块中点击“添加”按钮，示例中以指定分隔符为例。

 ![](/images/operation/rule/config/config_5.png)

在各个输入框中输入如下内容：

| 类型名称    | 自定义敏感类型    |
| ----------- | ----------------- |
| 示例        | 张三\|13598787656 |
| 分区方式    | 指定分隔符        |
| 分隔符      | \|                |
| A区匹配规则 | 其他敏感类型      |
| B区匹配规则 | 包含->勾选数字    |

a. 分区方式：系统目前支持指定分隔符和数据分段两种方式；

b. 匹配规则：目前系统支持无校验、正则匹配、数据字段、包含、等于、区间、其他敏感类型等七种敏感类型，每个分区的数据都符合分区的校验规则时才能添加敏感类型。

无校验：该分区的数据不进行校验，任何字符串都可以匹配；

正则匹配：该分区的数据必须符合输入的正则表达式，才能校验成功；

数据字典：该分区中的数据必须包含在数据字典中才能校验成功，数据字典可在脱敏配置管理中的数据字典页面进行配置；

包含：该分区的数据必须包含所选择的字符例如数据、中文、英文等字符才能校验成功；

等于：该分区的数据必须包含在输入的关键字中才能校验成功；

区间：该分区的数据只能是整数、浮点数或日期格式的数据，且必须包含在输入的区间中才能校验成功；

其他敏感类型：该分区的数据必须符合其他敏感类型的校验规则才能校验成功。

点击“校验”，系统会有校验效果的一个展示，展示覆盖、随机、替换、映射、SHA256脱敏效果，如下图所示，点击添加即可完成一个自定义敏感类型的添加。

 ![](/images/operation/rule/config/config_6.png)

### 5.5.2 删除和修改

删除：敏感类型删除可以进行批量操作和单一操作，点击敏感类型左侧的选择按钮来完成敏感类型的选择，然后点击删除按钮就可以删除选中的敏感类型。

修改：修改敏感类型点击右侧操作栏中的修改按钮即可对敏感类型的信息进行修改

注：内置敏感类型无法被删除和修改。

### 5.5.3 其他操作

查看详情：点击脱敏类型右侧的详情按钮，会展示脱敏类型的详细信息。

搜索：可以对类型名称进行模糊搜索

系统会内置常用的脱敏类型，方便用户在未创建自定义脱敏类型的情况下直接使用进行数据脱敏。

## 5.5 数据字典

数据字典即敏感类型分区数据的集合，数据字典模块系统内置35个字典信息，也可点击添加按钮，自定义数据字典信息。

### 5.5.1 数据字典添加

在数据字典模块点击“添加”按钮，输入字典名称和描述点击“添加”按钮完成一个自定义数据字典的添加。

![](/images/operation/rule/config/config_7.png) 

点击数据字典内容中的“添加”按钮，可选择文件添加和手动添加两种方式。文档中以手动添加为例，文件添加的方式同应用层账号添加一致，此处不再阐述。点击“添加”按钮即可完成数据字典内容的添加。

![](/images/operation/rule/config/config_8.png) 

### 5.5.2 其他操作

删除：删除数据字典包括删除数据字典列表和删除数据字典内容，删除字典列表的话里面的内容也会被删除。选中需要删除的项之后点击“删除”按钮即可。

修改；修改数据字典包括修改数据字典列表和修改数据字典内容。点击内容右侧的修改按钮即可对数据字典列表和数据字典内容的所有信息进行修改。

查询：可以对数据字典进行模糊查询

查看详情：选中后点击数据字典列表右侧的详情按钮，可以查看到数据字典名称和描述。

## 5.6 黑白名单

当对数据库执行脱敏操作时，如果对某个字段配置了黑名单，且该字段的某条记录的值在黑名单中，则将该条记录所在的整行数据进行过滤，不记录在目标表或者目标文件中。

当对数据库执行脱敏操作时，如果对某个字段配置了白名单，且该字段的某条记录的值在白名单中，则将该条记录所在的整行数据不执行脱敏操作，直接将原值记录在目标表或者目标中。

此处的黑白名单配置仅针对静态脱敏任务进行配置。

### 5.6.1 添加

点击“添加”按钮，进入添加黑白名单的界面。输入名称，选择源数据库和黑白名单的种类，在下面的表名和字段名中进行选择。点击字段名右侧的添加按钮加入黑白名单的匹配内容。例如原address表中的address字段有一条数据为“广东省深圳市宝安区安乐社区”，用户想将其加入黑名单，则在匹配内容中填入该数据即可。

 ![](/images/operation/rule/config/config_9.png)

注：每个表只能添加一个黑名单或者白名单，当黑白名单冲突时以黑名单为主

### 5.6.2 删除和修改

删除：黑白名单删除可以进行批量操作和单一操作，点击黑白名单左侧的选择按钮来完成黑白名单的选择，然后点击删除按钮就可以删除选中的黑白名单。

修改：点击每一条黑白名单右侧的修改按钮进入修改界面，可以对除名称和数据源以外的所有信息进行修改。

### 5.6.3 其他操作

查看详情：点击黑白名单右侧的详情按钮，会展示黑白名单的详细信息。

搜索：可以对黑白名单名称进行模糊搜索。

筛选：可以对表头的配置类型进行筛选。
